---
import { getEntry, render } from 'astro:content';
import Page from '@layouts/page/Page.astro';
import { buildRelationsGraph, getBreadcrumbs } from '@/lib/relations';

const entry = await getEntry('pages', 'index');
if (!entry) {
  return Astro.redirect('/404');
}

const { Content, headings } = await render(entry);
const { data } = entry;

// Build relations graph and get breadcrumbs (empty for index)
const { graph, pages } = await buildRelationsGraph();
const breadcrumbs = getBreadcrumbs('index', graph, pages);
---

<Page
  title={data.title}
  description={data.description}
  created={data.created}
  modified={data.modified}
  headings={headings}
  breadcrumbs={breadcrumbs}
  currentSlug="index"
>
  <Content />
</Page>
